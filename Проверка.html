<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –†–µ—Ü–µ–Ω–∑–µ–Ω—Ç –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–±–æ—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            color: white;
            padding: 30px;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 40px;
        }

        @media (max-width: 900px) {
            main {
                grid-template-columns: 1fr;
            }
        }

        .upload-section, .result-section {
            background: #f8fafc;
            border-radius: 15px;
            padding: 30px;
            border: 2px dashed #cbd5e1;
        }

        .upload-section {
            border-color: #4f46e5;
        }

        .upload-area {
            text-align: center;
            padding: 40px 20px;
            border: 3px dashed #94a3b8;
            border-radius: 12px;
            margin: 20px 0;
            transition: all 0.3s;
            cursor: pointer;
            background: white;
        }

        .upload-area:hover {
            border-color: #4f46e5;
            background: #f0f9ff;
        }

        .upload-icon {
            font-size: 48px;
            color: #4f46e5;
            margin-bottom: 15px;
        }

        .file-input {
            display: none;
        }

        .file-info {
            margin-top: 15px;
            color: #64748b;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analyze-btn {
            background: linear-gradient(90deg, #10b981, #34d399);
            color: white;
            flex: 1;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }

        .analyze-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        .clear-btn {
            background: #f1f5f9;
            color: #475569;
        }

        .clear-btn:hover {
            background: #e2e8f0;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #e2e8f0;
            border-top-color: #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .result-section {
            max-height: 700px;
            overflow-y: auto;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .score-badge {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .errors-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .error-item {
            background: white;
            border-left: 5px solid #ef4444;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .error-item.warning {
            border-left-color: #f59e0b;
        }

        .error-item.success {
            border-left-color: #10b981;
        }

        .error-category {
            font-weight: bold;
            color: #1e293b;
            font-size: 1.1rem;
            margin-bottom: 8px;
        }

        .error-text {
            color: #475569;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .error-quote {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #cbd5e1;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 10px 0;
            color: #475569;
        }

        .recommendation {
            background: #f0f9ff;
            padding: 12px;
            border-radius: 8px;
            color: #0369a1;
            font-size: 0.95rem;
        }

        footer {
            text-align: center;
            padding: 25px;
            background: #f8fafc;
            color: #64748b;
            border-top: 1px solid #e2e8f0;
        }

        .api-key-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            font-size: 14px;
            margin-top: 15px;
        }

        .api-key-input:focus {
            outline: none;
            border-color: #4f46e5;
        }

        .status-message {
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }

        .status-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .status-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéì AI –†–µ—Ü–µ–Ω–∑–µ–Ω—Ç –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–±–æ—Ç</h1>
            <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ—é –∫—É—Ä—Å–æ–≤—É—é –≤ —Ñ–æ—Ä–º–∞—Ç–µ .docx –∏ –ø–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</p>
        </header>

        <main>
            <section class="upload-section">
                <h2>üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç—ã</h2>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∫—É—Ä—Å–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ .docx</p>
                
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">üìÑ</div>
                    <p><strong>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞</strong></p>
                    <p>–∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ–≥–æ —Å—é–¥–∞</p>
                    <p style="color: #64748b; font-size: 14px; margin-top: 10px;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç .docx</p>
                </div>

                <div class="file-info" id="fileInfo">
                    –§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω
                </div>

                <input type="file" id="fileInput" class="file-input" accept=".docx" onchange="handleFileSelect(event)">
                
                <div class="status-message" id="statusMessage"></div>

                <div class="controls">
                    <button class="analyze-btn" id="analyzeBtn" onclick="analyzeDocument()" disabled>
                        <span>üîç</span> –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
                    </button>
                    <button class="clear-btn" onclick="clearAll()">
                        <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>–ò–¥–µ—Ç –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞... –≠—Ç–æ –∑–∞–π–º–µ—Ç 10-20 —Å–µ–∫—É–Ω–¥</p>
                    <p style="color: #64748b; font-size: 14px; margin-top: 10px;">–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Ä–∞—Å—á–µ—Ç—ã, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</p>
                </div>
            </section>

            <section class="result-section">
                <div class="result-header">
                    <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏</h2>
                    <div class="score-badge" id="scoreBadge">‚Äì / 10</div>
                </div>
                
                <div class="errors-list" id="errorsList">
                    <div class="error-item success">
                        <div class="error-category">–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ</div>
                        <div class="error-text">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞</div>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>¬© 2024 AI –†–µ—Ü–µ–Ω–∑–µ–Ω—Ç –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–±–æ—Ç | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Gemini AI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>
            <p style="font-size: 12px; margin-top: 10px;">–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, —Ä–∞—Å—á–µ—Ç—ã –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–û–°–¢</p>
        </footer>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let selectedFile = null;
        const API_KEY = 'AIzaSyBhCO1c4L2yZY1RLRfvh_lYNKr2TgvVzWk'; // –í–∞—à –∫–ª—é—á Gemini
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';

        // –ü—Ä–æ–º–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        const ANALYSIS_PROMPT = `–¢—ã ‚Äî —Å—Ç—Ä–æ–≥–∏–π –Ω–∞—É—á–Ω—ã–π —Ä–µ—Ü–µ–Ω–∑–µ–Ω—Ç –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–±–æ—Ç –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º. 
        –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∫—É—Ä—Å–æ–≤—É—é —Ä–∞–±–æ—Ç—É –∏ —Å–æ—Å—Ç–∞–≤—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º:

        1. –°–¢–†–£–ö–¢–£–†–ù–´–ï –û–®–ò–ë–ö–ò:
        - –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤: —Ç–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç, —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ, –≤–≤–µ–¥–µ–Ω–∏–µ, –≥–ª–∞–≤—ã, –∑–∞–∫–ª—é—á–µ–Ω–∏–µ, —Å–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–¥–∞–Ω–∏—é
        - –õ–æ–≥–∏—á–µ—Å–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª–æ–≤

        2. –û–§–û–†–ú–õ–ï–ù–ò–ï (–ø–æ –ì–û–°–¢):
        - –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ç–∏—Ç—É–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
        - –ù–∞–ª–∏—á–∏–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü, —Ä–∏—Å—É–Ω–∫–æ–≤, —Ç–∞–±–ª–∏—Ü, —Ñ–æ—Ä–º—É–ª
        - –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã (–ì–û–°–¢ 7.0.100-2018)
        - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

        3. –°–û–î–ï–†–ñ–ê–¢–ï–õ–¨–ù–´–ï –û–®–ò–ë–ö–ò:
        - –ù–∞–ª–∏—á–∏–µ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –≤–≤–µ–¥–µ–Ω–∏—è (–∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å, —Ü–µ–ª—å, –∑–∞–¥–∞—á–∏, –æ–±—ä–µ–∫—Ç, –ø—Ä–µ–¥–º–µ—Ç, –º–µ—Ç–æ–¥—ã)
        - –ì–ª—É–±–∏–Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏ —Ç–µ–º–µ
        - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–æ–≤ –≤ –∑–∞–∫–ª—é—á–µ–Ω–∏–∏
        - –ù–∞—É—á–Ω—ã–π —Å—Ç–∏–ª—å –∏–∑–ª–æ–∂–µ–Ω–∏—è

        4. –†–ê–°–ß–ï–¢–ù–û-–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò (–¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç):
        - –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö –±–ª–æ–∫–æ–≤
        - –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
        - –°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–æ—Ä–º—É–ª—ã –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
        - –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è/–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

        –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:
        –ù–∞—á–Ω–∏ —Å –æ–±—â–µ–π –æ—Ü–µ–Ω–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: "–û–¶–ï–ù–ö–ê: X/10", –≥–¥–µ X - —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10.
        –ó–∞—Ç–µ–º –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π –æ—à–∏–±–∫–∏ —É–∫–∞–∂–∏:
        [–ö–ê–¢–ï–ì–û–†–ò–Ø: –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏]
        [–¢–ò–ü: –û–®–ò–ë–ö–ê/–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï/–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø]
        [–û–ü–ò–°–ê–ù–ò–ï: –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã]
        [–¶–ò–¢–ê–¢–ê: —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ —Å –æ—à–∏–±–∫–æ–π, –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ]
        [–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: –∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å]
        ---

        –î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:`;

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                if (file.name.endsWith('.docx')) {
                    selectedFile = file;
                    document.getElementById('fileInfo').innerHTML = `
                        <strong>–í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª:</strong> ${file.name}<br>
                        <strong>–†–∞–∑–º–µ—Ä:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
                        <strong>–¢–∏–ø:</strong> ${file.type}
                    `;
                    document.getElementById('analyzeBtn').disabled = false;
                    showStatus('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω! –ù–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç"', 'success');
                } else {
                    showStatus('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ .docx', 'error');
                }
            }
        }

        // –ü–æ–∫–∞–∑ —Å—Ç–∞—Ç—É—Å–∞
        function showStatus(message, type) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.className = 'status-message ' + (type === 'success' ? 'status-success' : 'status-error');
            statusEl.style.display = 'block';
            
            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 5000);
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞
        async function analyzeDocument() {
            if (!selectedFile) {
                showStatus('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª', 'error');
                return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            document.getElementById('loading').style.display = 'block';
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('errorsList').innerHTML = `
                <div class="error-item">
                    <div class="error-category">–ò–¥–µ—Ç –∞–Ω–∞–ª–∏–∑...</div>
                    <div class="error-text">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</div>
                </div>
            `;

            try {
                // –ß–∏—Ç–∞–µ–º —Ç–µ–∫—Å—Ç –∏–∑ DOCX
                const text = await readDocxFile(selectedFile);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Gemini
                const analysis = await sendToGemini(text);
                
                // –ü–∞—Ä—Å–∏–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                displayResults(analysis);
                
                showStatus('–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞:', error);
                showStatus('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞: ' + error.message, 'error');
                
                document.getElementById('errorsList').innerHTML = `
                    <div class="error-item">
                        <div class="error-category">–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞</div>
                        <div class="error-text">${error.message}</div>
                    </div>
                `;
            } finally {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('analyzeBtn').disabled = false;
            }
        }

        // –ß—Ç–µ–Ω–∏–µ DOCX —Ñ–∞–π–ª–∞
        async function readDocxFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    
                    // –ü—Ä–æ—Å—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ DOCX (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
                    // –ó–¥–µ—Å—å –∏–º–∏—Ç–∏—Ä—É–µ–º —á—Ç–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
                    const decoder = new TextDecoder('utf-8');
                    let text = decoder.decode(arrayBuffer);
                    
                    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è API
                    text = text.substring(0, 30000);
                    
                    resolve(text);
                };
                
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Gemini API
        async function sendToGemini(text) {
            const prompt = ANALYSIS_PROMPT + '\n\n' + text.substring(0, 30000);
            
            const response = await fetch(`${GEMINI_API_URL}?key=${API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.1,
                        maxOutputTokens: 2000,
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`API –æ—à–∏–±–∫–∞: ${response.status}`);
            }

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content.parts[0].text) {
                return data.candidates[0].content.parts[0].text;
            } else {
                throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç API');
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResults(analysisText) {
            const errorsList = document.getElementById('errorsList');
            errorsList.innerHTML = '';
            
            // –ò–∑–≤–ª–µ–∫–∞–µ–º –æ—Ü–µ–Ω–∫—É
            const scoreMatch = analysisText.match(/–û–¶–ï–ù–ö–ê:\s*(\d+(?:\.\d+)?)\/10/);
            if (scoreMatch) {
                const score = scoreMatch[1];
                document.getElementById('scoreBadge').textContent = `${score}/10`;
            }
            
            // –ü–∞—Ä—Å–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
            const sections = analysisText.split('---');
            
            sections.forEach(section => {
                if (section.trim()) {
                    const categoryMatch = section.match(/\[–ö–ê–¢–ï–ì–û–†–ò–Ø:\s*(.+?)\]/);
                    const typeMatch = section.match(/\[–¢–ò–ü:\s*(.+?)\]/);
                    const descMatch = section.match(/\[–û–ü–ò–°–ê–ù–ò–ï:\s*([\s\S]+?)(?=\[–¶–ò–¢–ê–¢–ê:|\[–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:|$)/);
                    const quoteMatch = section.match(/\[–¶–ò–¢–ê–¢–ê:\s*([\s\S]+?)(?=\[–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:|$)/);
                    const recMatch = section.match(/\[–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:\s*([\s\S]+?)(?=\[–ö–ê–¢–ï–ì–û–†–ò–Ø:|$)/);
                    
                    if (descMatch) {
                        const errorItem = document.createElement('div');
                        
                        let typeClass = 'error-item';
                        if (typeMatch) {
                            if (typeMatch[1].includes('–û–®–ò–ë–ö–ê')) {
                                typeClass += '';
                            } else if (typeMatch[1].includes('–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï')) {
                                typeClass += ' warning';
                            } else if (typeMatch[1].includes('–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø')) {
                                typeClass += ' success';
                            }
                        }
                        
                        errorItem.className = typeClass;
                        
                        let html = '';
                        if (categoryMatch) {
                            html += `<div class="error-category">${categoryMatch[1]}</div>`;
                        }
                        
                        html += `<div class="error-text">${descMatch[1].trim()}</div>`;
                        
                        if (quoteMatch) {
                            html += `<div class="error-quote">${quoteMatch[1].trim()}</div>`;
                        }
                        
                        if (recMatch) {
                            html += `<div class="recommendation">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: ${recMatch[1].trim()}</div>`;
                        }
                        
                        errorItem.innerHTML = html;
                        errorsList.appendChild(errorItem);
                    }
                }
            });
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç
            if (errorsList.children.length === 0) {
                const errorItem = document.creat